from datetime import datetime

# INFO: loading here to use the correct level of indirection (every field generator must be here for this module)
from patton_server.dal.common.fields import uuid, cpe_norm # noqa


def datetimep(datetimestr):
    # TODO: research about trailing timezone
    return datetime.strptime(datetimestr[:-10], '%Y-%m-%dT%H:%M:%S')


def cwe(vuln):
    try:
        return vuln.find('{*}cwe').attrib['id']
    except AttributeError:
        # TODO: try None
        return ''
