language: python
python:
    - "3.6"

env:
  - POSTGRES_PASSWORD=postgres
  - PATTON_HTTP_PORT=8000
  - PATTON_HTTP_WORKERS=1

services:
  - postgresql
  - docker

# command to install dependencies
install: "make"

addons:
  apt:
    packages:
      - libenchant-dev

before_script:
   psql -c 'create database patton;' -U postgres

# command to run tests
script:
    - make lint test-coverage

deploy:
    # release image to DockerHub
  - provider: script
    script: release/image_dockerhub.sh
    on:
      branch: master
